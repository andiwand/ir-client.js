var ir=ir||{};ir.client=ir.client||{},$.extend(ir.remote,{defaultSetting:{errorFrequency:new andiwand.MarginOfError(.1,!1),errorTime:new andiwand.MarginOfError(.1,!1)}});var ir=ir||{};ir.Frame=function(){},ir.Frame.prototype.toString=function(){return JSON.stringify(this.serialize())},ir.Frame.prototype.getProtocol=andiwand.notImplemented,ir.Frame.prototype.getFrequency=function(){return this.getProtocol().frequency},ir.Frame.prototype.encode=function(a){return this.getProtocol().encode(this,a)},ir.Frame.prototype.decode=function(a,b){return this.getProtocol().decode(a,b)},ir.Frame.serialize=function(a){andiwand.assert(a instanceof ir.Frame);var b={},c=a.getProtocol();return b.protocol=c.name,b.data=a.serialize(),b},ir.Frame.prototype.serialize=andiwand.notImplemented,ir.Frame.deserialize=function(a){var b=ir.Protocol.map[a.protocol],c=b.getFrameClass();return c.deserialize(a.data)};var ir=ir||{};ir["interface"]=ir["interface"]||{},$.extend(ir["interface"],{discover:andiwand.notImplemented,send:andiwand.notImplemented,receive:andiwand.notImplemented,configure:andiwand.notImplemented});var ir=ir||{};ir.Protocol=function(a,b){andiwand.assert(andiwand.isString(a)),andiwand.assert(null===b||andiwand.isInt(b)),this.name=a,this.frequency=b,ir.Protocol.map[a]=this},ir.Protocol.map={},ir.Protocol.prototype.toString=function(){return this.name+" protocol"},ir.Protocol.prototype.getFrameClass=andiwand.notImplemented,ir.Protocol.prototype.encode=function(a,b){andiwand.assert(a instanceof this.getFrameClass());var c=new ir.RawFrame(a.getFrequency(),[]),d=new ir.RawHelper(c,b);return this._encode(a,d,b),c},ir.Protocol.prototype._encode=andiwand.notImplemented,ir.Protocol.prototype.decode=function(a,b){andiwand.assert(a instanceof ir.RawFrame);var c=new ir.RawHelper(a,b);return this._decode(c,b)},ir.Protocol.prototype._decode=andiwand.notImplemented;var ir=ir||{};ir.Station=function(a,b,c){andiwand.assert(andiwand.isString(a)),andiwand.assert(andiwand.isString(b)),andiwand.assert(andiwand.isInt(c)),this.name=a,this._address=b,this._port=c},ir.Station.discover=function(a,b,c){andiwand.assert(andiwand.isInt(a)),andiwand.assert(andiwand.isInt(b)),andiwand.assert(andiwand.isInt(c)),ir["interface"].discover(a,b,c)},ir.Station.prototype.send=function(a){andiwand.assert(a instanceof ir.Frame),ir["interface"].send(this,a)},ir.Station.prototype.receive=function(){return ir["interface"].receive(this)},ir.Station.prototype.configure=function(a,b,c){andiwand.assert(andiwand.isString(a)),andiwand.assert(andiwand.isString(b)),andiwand.assert(andiwand.isString(c)),ir["interface"].configure(this,a,b,c)},ir.Station.prototype.serialize=function(){var a={};return a.name=this.name,a.address=this._address,a.port=this._port,a},ir.Station.deserialize=function(a){return new ir.Station(a.name,a.address,a.port)};var ir=ir||{};ir.RawHelper=function(a,b){andiwand.assert(a instanceof ir.RawFrame),andiwand.assert(andiwand.isObject(b)),this._raw=a,this._settings=b,this._pos=0},ir.RawHelper.prototype.size=function(){return this._raw._times.length},ir.RawHelper.prototype.position=function(a){return a?(andiwand.assert(isInt(a)),void(this._pos=a)):this._pos},ir.RawHelper.prototype.write=function(a){this._raw._times[this._pos]=a,this._pos++},ir.RawHelper.prototype.matchFrequency=function(a){var b=this._settings[ir["const"].error_frequency_key];return b.check(this._raw._frequency,a)},ir.RawHelper.prototype.matchTime=function(a){var b=this._settings[ir["const"].error_time_key],c=this._raw._times[this._pos],d=b.check(c,a);return d&&this._pos++,d},ir.RawHelper.prototype.match=function(a){andiwand.assert(andiwand.isArray(a));for(var b=0;b<a.length;b++)if(this.matchTime(a[b]))return b;return-1};var ir=ir||{};ir.NecFrame=function(a){ir.Frame.call(this,ir.Frame),andiwand(andiwand.isInt32(a)),this._data=a},ir.NecFrame.prototype=Object.create(ir.Frame.prototype),ir.NecFrame.prototype.constructor=ir.NecFrame,ir.NecFrame.prototype.getProtocol=andiwand.dynamicGet(ir,"NecProtocol"),ir.NecFrame.prototype.serialize=function(){return this._data},ir.NecFrame.deserialize=function(a){return new ir.NecFrame(a)};var ir=ir||{};ir.RawFrame=function(a,b){ir.Frame.call(this,ir.Frame),andiwand(andiwand.isInt(a)),andiwand(andiwand.isArray(b)),this._frequency=a,this._times=b},ir.RawFrame.prototype=Object.create(ir.Frame.prototype),ir.RawFrame.prototype.constructor=ir.RawFrame,ir.RawFrame.prototype.getProtocol=andiwand.dynamicGet(ir,"RawProtocol"),ir.RawFrame.prototype.getFrequency=function(){return this.frequency},ir.RawFrame.prototype.serialize=function(){var a={};return a.frequency=this._frequency,a.times=this._times,a},ir.RawFrame.deserialize=function(a){return new ir.RawFrame(a.frequency,a.times)};var ir=ir||{};ir.NecProtocol=new ir.Protocol("NEC",38222),$.extend(ir.NecProtocol,{_TIME_INIT_MARK:.009,_TIME_INIT_SPACE:.0045,_TIME_REPEAT_SPACE:.00225,_TIME_BIT_MARK:5625e-7,_TIME_ZERO_SPACE:5625e-7,_TIME_ONE_SPACE:.0016875,_TIME_END_MARK:5625e-7,_TIMES_DEFAULT:67,_TIMES_REPEAT:3,_BITS:32,_REPEAT:4294967295,getFrameClass:andiwand.dynamicGet(ir,"NecFrame"),_encode:function(a,b,c){if(b.write(this._TIME_INIT_MARK),nec._data===this._REPEAT)b.write(this._TIME_REPEAT_SPACE);else{b.write(this._TIME_INIT_SPACE);for(var d=0;d<this._BITS;d++)b.write(this._TIME_BIT_MARK),0!==(nec._data>>d&1)?b.write(this._TIME_ONE_SPACE):b.write(this._TIME_ZERO_SPACE)}b.write(this._TIME_END_MARK)},_decode:function(a,b){var c=0;if(!a.matchFrequency(this.frequency))return null;if(!a.matchTime(this._TIME_INIT_MARK))return null;if(a.matchTime(this._TIME_INIT_SPACE))for(var d=0;d<this._BITS;d++){if(!a.matchTime(this._TIME_BIT_MARK))return null;if(a.matchTime(this._TIME_ONE_SPACE))c|=1<<d;else if(!a.matchTime(this._TIME_ZERO_SPACE))return null}else{if(!a.matchTime(this._TIME_INIT_SPACE))return null;c=this._REPEAT}return a.matchTime(this._TIME_END_MARK)?a.position()!=a.size()?null:new ir.NecFrame(c):null}});var ir=ir||{};ir.RawProtocol=new ir.Protocol("RAW",null),$.extend(ir.RawProtocol,{getFrameClass:andiwand.dynamicGet(ir,"RawFrame"),encode:function(a,b){return a},decode:function(a,b){return a}});